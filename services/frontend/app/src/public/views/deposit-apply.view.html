<div ng-controller="DepositApplicationController as ctrl"
     ng-init="ctrl.getData()">
  <section>
    <h1>Оформление вклада</h1>
    <form ng-submit="ctrl.apply()">
      <div class="alert alert-danger"
           role="alert"
           ng-if="ctrl.errors">
        <b>{{ctrl.errors}}</b>
      </div>

      <div class="form-group">
        <label for="account-control">Счет, с которого будут списаны средства:</label>
        <select class="form-control"
                id="account-control"
                ng-model="ctrl.account_id"
                required>
          <option></option>
          <option ng-repeat="account in ctrl.accounts"
                  value="{{account.id}}">
            {{account.number}}
            ({{ctrl.accountStatuses[account.status]}}, Остаток: {{account.residue}} {{account.residue_currency}})
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="currency-control">Валюта:</label>
        <select class="form-control"
                id="currency-control"
                ng-model="ctrl.currency"
                required>
          <option></option>
          <option ng-repeat="(code, currency) in ctrl.currencies" value="{{code}}">
            {{currency}}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="amount-control">
          Сумма, в белоруских рублях
          <span ng-if="ctrl.currency">
            (минимум {{ctrl.template.currency[ctrl.currency].min_amount}}):
          </span>
        </label>
        <input type="number"
               class="form-control"
               ng-model="ctrl.amount"
               placeholder="Сумма"
               id="amount-control"
               min="{{ctrl.template.currency[ctrl.currency].min_amount}}"
               required>
      </div>

      <div class="form-group">
        <label for="duration-control">
          Продолжительность, в месяцах
        </label>
        <select class="form-control"
                ng-model="ctrl.plan_index"
                ng-disabled="!ctrl.currency"
                required
                id="duration-control">
          <option></option>
          <option ng-repeat="plan in ctrl.template.currency[ctrl.currency].percentage"
                  value="{{$index}}">
            {{plan.term}}
          </option>
        </select>
      </div>

      <div class="form-group">
        <div class="row-offset-0 col-md-offset-5 col-md-2">
          <button type="submit"
                  class="form-control btn btn-info button">
            Подтвердить
          </button>
        </div>
      </div>
    </form>
  </section>
</div>
